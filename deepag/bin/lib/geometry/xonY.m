% [y,z] = xonY(x,Y) - projection of x on subspace generated by columns of Y
%
% x = a column
% Y = matrix of generators in its columns
% y = projeciton of x to the space generated by columns of Y
% z = x-y, i.e. the (y,z) is the ortogonal decomposition of x by Y

% T. Pajdla, pajdla@cmp.felk.cvut.cz 
function [y,z] = xonY(x,Y)

A = full(Y'*Y);
b = full(Y'*x);
a = pinv(A)*b;
if issparse(Y)||issparse(x), a = sparse(a); end
y = Y*a;
z = x-y;