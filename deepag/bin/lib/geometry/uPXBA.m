% [u,P,X,e] = uPXBA(u,P,X,op,ic,ip) - bundle adjustment of 3D points X, camaras P and image point u
%
% u = {u1, u2, ...} of 2 x n image projections
% P = {P1, P2, ...} of camera descriptions, see X2u
% X = 3 x n 3D points
% ic = {i1, i2, ...} of 1 x n camera ids for u's (if missing, all cameras see all points)
% ip = {i1, i2, ...} of 1 x n point ids for u's (if missing, all cameras see all points) 
% e = [e1, e2, ..., e_numit] ... square root of the mean of squared errors at each itteration
% op = parameters
%      BUNDLE ADJUSTMENT: 
%      op.proj_func =
%                     0 - direct access to blocks of parameters
%                     for projection function 0 - the 7 camera blocks are [q1,q2,q3][t0,t1,t2][fx][ar][x0,y0][s][r1,r2]
%                     fixed_parmask - for each block of each camera 0-free/1-fixed
%                     example of adjusting only camera R and C
%                     fixed_blocks = [0 0 1 1 1 1 1];
%                     for i = 1:interface.ncams
%                        interface.fixed_parmask((i-1)*7+1:i*7) = fixed_blocks;
%                     end
%
%                     Predefined adjustment modes
%
%                     1-5 standard perspective projection
%                     6-10 standard perspective projection with radial distortion
%                     1 - K,R,C = -R*C adjusted
%                     2 - K fixed, R,C adjusted
%                     3 - ar and s fixed, other adjusted
%                     4 - s is fixed, other adjusted
%                     5 - ar,s,x0,y0 is fixed, other adjusted
%                     the same holds for 6-10 plus there is radial distortion
%                     101 - R's adjusted, all other fixed
%                     102 - fixed pixel size & skew and & first C and R fixed
%                     103 - intrinsics and the first center and first rotation fixed
%                     104 - intrinsics and the first and second center and first rotation fixed
%                     105 - the first camera fixed, the second camera ar, s, x0, y0 fixed, the second f, R, C adjusted
%                     
%      op.constant_cameras(i) = 
%                      1 - camera fixed
%                      0 - camera adjusted
%      op.constant_points(i) = 
%                      1 - point fixed
%                      0 - point adjusted
%      op.p_tolerance = stopping criterion - change of optimized variables
%      op.g_tolerance = stopping criterion - size of the gradient
%      op.f_tolerance = stopping criterion - change of the objective
%      op.num_iterations = the maximum naumber of iterations
%      op.robustify = robust loss function 
%                     0 - least squares
%                     1 - Huber's loss
%      op.num_threads =  number of threads
%      op.verbose = info printout
%                     0 - info print out off
%                     1 - info print out on

% T. Pajdla, pajdla@cmp.felk.cvut.cz, 2015-08-08
function [u,P,X,e] = uPXBA(u,P,X,op,ic,ip)
if nargin>0
    % Set BA parameters
    ba.proj_func = op.proj_func; % projection function
    ba.constant_cameras = op.constant_cameras; % fixed cameras
    ba.constant_points = op.constant_points; % fixed points
    ba.p_tolerance = op.p_tolerance; % stopping criterion - change of optimized variables
    ba.g_tolerance = op.g_tolerance; % stopping criterion - size of the gradient
    ba.f_tolerance = op.f_tolerance; % stopping criterion - change of the objective
    ba.num_iterations = op.num_iterations; % the maximum number of LM iterations, default 5
    ba.robustify = op.robustify; % robust loss function (0 - least squares, 1 - Huber's loss), default 0
    ba.num_threads = op.num_threads; % number of threads, default 1
    ba.verbose = op.verbose;
    % Reformat data
    if size(X,1)==4
        X = h2a(X);
    end
    ba.ncams = numel(P); % number of cameras
    ba.npts = size(X,2); % number of points
    ba.nobs = sum(cellfun(@(x) size(x,2),u)); % numbers of observations
    % aditional modes introduced in uPXBA
    fixBA = false;
    switch ba.proj_func
        case 101 % adjust R's only
            ba.proj_func = 0;
            fb = [0 1 1 1 1 1 1]; % adjust R's only
            for i = 1:ba.ncams
                ba.fixed_parmask((i-1)*7+1:i*7) = fb;
            end
        case 102 % squared pixels & first center and rotation fixed
            ba.proj_func = 0;
            ba.fixed_parmask(1:7) = [1 1 0 1 0 1 1]; % '[R C fx ar u0 s rd]'
            for i = 2:ba.ncams
                ba.fixed_parmask((i-1)*7+1:i*7) = [0 0 0 1 0 1 1]; % 
            end            
        case 103 % intrinsics and the first center and rotation fixed
            ba.proj_func = 0;
            ba.fixed_parmask(1:7) = [1 1 1 1 1 1 1]; % '[R C fx ar u0 s rd]'
            for i = 2:ba.ncams
                ba.fixed_parmask((i-1)*7+1:i*7) = [0 0 1 1 1 1 1]; % only extrinsics
            end  
        case 104 % intrinsics and the first and second center and first rotation fixed    
            ba.proj_func = 0;
            ba.fixed_parmask(1:7)  = [1 1 1 1 1 1 1]; % '[R C fx ar u0 s rd]'
            ba.fixed_parmask(8:14) = [0 1 1 1 1 1 1]; % '[R C fx ar u0 s rd]'
            for i = 3:ba.ncams
                ba.fixed_parmask((i-1)*7+1:i*7) = [0 0 1 1 1 1 1]; % only extrinsics
            end
        case 105 % the first camera fixed, the second camera ar, s, x0, y0 fixed, the second f, R, C adjusted 
            ba.proj_func = 0;
            ba.fixed_parmask(1:7)  = [1 1 1 1 1 1 1]; % '[R C fx ar u0 s rd]'
            ba.fixed_parmask(8:14) = [0 0 0 1 1 1 1]; % '[R C fx ar u0 s rd]'
            for i = 3:ba.ncams
                ba.fixed_parmask((i-1)*7+1:i*7) = [0 0 1 1 1 1 1]; % only extrinsics
            end            
        otherwise
            % all has already been set
    end
    % OBSERVATIONS
    % 3D point point_index(i) projects into camera camera_index(i) creating projection observations((i-1)*2+1:i*2)
    % The order of observation added does not matter. Camera_index and point_index start from 0 (C convention)!
    for i=1:numel(P) % for all cameras
        ob{i} = u{i}(:)';
        if nargin<5
            ip{i} = 0:size(u{i},2)-1;
            ic{i} = (i-1)*ones(1,size(u{i},2));
        else % ic, ip on input
            ip{i} = ip{i}-1; % from Matlab to C indexing convention
            ic{i} = ic{i}-1;
        end
    end
    ba.point_index = cat(2,ip{:});
    ba.camera_index = cat(2,ic{:});
    ba.observations = cat(2,ob{:});
    % Initial parameters
    % N cameras, M points: [camera1 ... cameraN point1 ... pointM]
    % cameraX = [q1 q2 q3 q4 t1 t2 t3 fx x0 y0 ar s r1 r2 r3 r4 r5], t = -R*C
    % ar = fy/fx, r1,...,r5 radial distortion coefficients, now only r1 and r2 used - bundler style
    % pointX = [x y z]
    for i=1:numel(P) % for all cameras
        if size(P{i})==[3 4]
            [K{i},R{i}] = kr3(P{i}(:,1:3));
            K{i} = K{i}/K{i}(3,3); % BA assumes K(3,3)=1
            C{i} = -P{i}(:,1:3)\P{i}(:,end);
            cp{i} = [r2q(R{i})' (-R{i}*C{i})' K{i}(1,1) K{i}(1,3) K{i}(2,3) K{i}(2,2)/K{i}(1,1) K{i}(1,2) 0 0 0 0 0];
        else
            error('uPXBA camera nust be 3x4 projection matrices');
        end
    end
    ba.parameters = [cat(2,cp{:}) X(:)'];
    % Bundle Adjustment
    [po,e] = cmp_bundle_adjuster_mex(ba);
    % patch: do not make it get worse 
    if length(e)<2 | e(1)<=e(end)
        u = []; P =[]; X =[]; e =[];
        return
    else
        e = sqrt(e/ba.nobs); % square root of the mean of squared errors)
    end
    % reshape to cameras and points
    X = reshape(po(ba.ncams*17+1:end),3,[]);
    % get the optimal transform of the reconstructed points to the true points
    % E = XY2rts([pO.X;pT.X]);
    % transform points by E, s
    % pO.X = h2a([E.s*E.r E.t;0 0 0 1]*a2h(pO.X));
    Ro = R; Ko = K; Co = C;% remember old K, R, C to fix "constant C" bug in BA
    for i=1:numel(P) % for all cameras
        p = po((i-1)*17+(1:17));
        R{i} =  q2r(p(1:4));
        if fixBA % to hack "constant C" bug in BA
            C{i} = -Ro{i}'*p(5:7)';
        else
            C{i} = -R{i}'*p(5:7)';
        end
        K{i} =  [p(8) p(12) p(9);0 p(8)*p(11) p(10);0 0 1];
        P{i} =  K{i}*R{i}*[eye(3) -C{i}];
        % project
        u{i} =  h2a(P{i}*a2h(X(:,ip{i}+1)));
    end
else % unit tests
    u.test = {'Single view absolute pose'};
    y = [1.3673241e+02   1.3673241e+02   4.1256906e+02   4.1256906e+02   4.1256906e+02   4.1267413e+02   4.1267413e+02   4.1267413e+02   5.4817767e+02   5.4817767e+02   5.4817767e+02   6.0848395e+02   7.0306598e+02   7.0306598e+02   7.0306598e+02   7.0306598e+02   7.5168719e+02   7.5168719e+02   7.5168719e+02   7.5168719e+02   7.7148669e+02   7.7148669e+02   8.6997858e+02   8.6997858e+02   8.6997858e+02   8.6997858e+02   8.6997858e+02   8.7871375e+02   8.8648730e+02   8.8648730e+02   8.8648730e+02   8.8648730e+02   9.4651575e+02   9.4651575e+02   9.5941150e+02   9.5941150e+02   1.1725268e+02   1.1725268e+02   1.1725268e+02   2.0019421e+02   2.0019421e+02   2.0019421e+02   2.0200499e+02   2.0200499e+02   2.0200499e+02   2.1331113e+02   2.1331113e+02   3.4098499e+02   3.4098499e+02   3.4098499e+02   3.3964890e+02   3.3964890e+02   4.5064276e+02   4.5064276e+02   4.5064276e+02   4.7227991e+02   4.7227991e+02   4.7227991e+02   5.7558496e+02   5.7558496e+02   5.7558496e+02   5.7558496e+02   6.1666943e+02   6.3495349e+02   6.3495349e+02   6.3495349e+02   6.3495349e+02   6.3495349e+02   6.3998035e+02   6.3998035e+02   6.3998035e+02   6.9052783e+02   6.9052783e+02   6.9052783e+02   6.9958655e+02   6.9958655e+02   6.9958655e+02   6.9958655e+02   6.9958655e+02   7.0327362e+02   7.0327362e+02   7.0327362e+02   7.0327362e+02   7.0327362e+02   7.0327362e+02   8.3907446e+02   8.3907446e+02   8.3907446e+02   8.3907446e+02   8.9208539e+02   8.9208539e+02   8.9208539e+02   9.0081384e+02   9.0081384e+02   9.0081384e+02   9.2519238e+02   9.2519238e+02   9.2519238e+02   9.2519238e+02   9.4554205e+02   9.4554205e+02   9.6462579e+02   9.6462579e+02   9.4433466e+02   9.4433466e+02   9.4433466e+02   9.4433466e+02   1.0364788e+03   1.0364788e+03   5.6669590e+01   5.6669590e+01   1.9438109e+02   1.9438109e+02   2.8601428e+02   2.8601428e+02   2.8601428e+02   3.5173276e+02   3.5173276e+02   3.5173276e+02   3.7182474e+02   3.7182474e+02   3.7182474e+02   4.6391562e+02   4.6391562e+02   6.8004529e+02   6.8004529e+02   6.8004529e+02   7.0507019e+02   7.0507019e+02   6.9609546e+02   6.9609546e+02   6.9609546e+02   6.9609546e+02   6.9609546e+02   6.9609546e+02   6.9609546e+02   7.1722339e+02   7.1722339e+02   7.3469489e+02   7.3469489e+02   7.5407489e+02   7.5407489e+02   7.6744373e+02   7.6744373e+02   7.6744373e+02   7.7717688e+02   7.7717688e+02   7.7717688e+02   8.3656024e+02   8.3656024e+02   9.2864178e+02   9.2864178e+02   9.2864178e+02   9.2864178e+02   9.3344250e+02   9.3344250e+02   9.3966119e+02   9.3966119e+02   9.5830780e+02   9.5830780e+02   9.5830780e+02   9.5830780e+02   9.5830780e+02   9.5830780e+02   1.0019261e+03   1.0019261e+03   1.0019261e+03   1.0019261e+03   1.1210633e+02   1.1210633e+02   1.1932966e+02   1.1932966e+02   1.9130907e+02   1.9130907e+02   1.9130907e+02   1.9243340e+02   1.9243340e+02   1.9243340e+02   3.2544156e+02   3.2544156e+02   5.9909259e+02   5.9909259e+02   5.9909259e+02   5.9723804e+02   5.9723804e+02   6.1222034e+02   6.1222034e+02   6.0704871e+02   6.0704871e+02   6.6041083e+02   6.6041083e+02   6.6041083e+02   6.6041083e+02   6.7106116e+02   6.7106116e+02   6.9639679e+02   6.9639679e+02   7.0692010e+02   7.0692010e+02   7.0430542e+02   7.0430542e+02   7.0430542e+02   7.0430542e+02   7.0430542e+02   7.0430542e+02   7.3734662e+02   7.3734662e+02   7.6808112e+02   7.6808112e+02   7.6808112e+02   7.9530829e+02   7.9530829e+02   7.9530829e+02   7.9530829e+02   7.9530829e+02   7.9530829e+02   7.9530829e+02   7.9530829e+02   7.9530829e+02   6.8357460e+01   6.8357460e+01   1.1068337e+02   1.1068337e+02   1.7116219e+02   1.7116219e+02   1.9683638e+02   1.9683638e+02   3.2121796e+02   3.2121796e+02   3.4453763e+02   3.4453763e+02   3.4453763e+02   3.4535492e+02   3.4535492e+02   3.4535492e+02   5.8694958e+02   5.8694958e+02   5.8694958e+02   5.8694958e+02   5.8694958e+02   5.8694958e+02   6.6433099e+02   6.6433099e+02   6.6433099e+02   6.6433099e+02   6.8141980e+02   6.8141980e+02   7.8811572e+02   7.8811572e+02   7.8811572e+02   7.8811572e+02   7.8811572e+02   7.8811572e+02   9.9116248e+02   9.9116248e+02   9.9116248e+02   1.0217286e+03   1.0217286e+03   1.0217286e+03   3.3347867e+02   3.3347867e+02   3.4508194e+02   3.4508194e+02   3.4508194e+02   3.7938635e+02   3.7938635e+02   3.7938635e+02   5.2814905e+02   5.2814905e+02   5.5403113e+02   5.5403113e+02   5.5403113e+02   5.9856628e+02   6.3911060e+02   6.3911060e+02   6.7721002e+02   7.4026453e+02   7.4026453e+02   7.4026453e+02   7.4026453e+02   8.1408643e+02   9.0907611e+02   9.0907611e+02   9.0907611e+02   9.0907611e+02   9.0907611e+02   9.1267017e+02   9.1267017e+02   9.7673840e+02   9.7673840e+02   1.0355258e+03   1.0355258e+03   8.7427757e+01   8.7427757e+01   8.7427757e+01   8.7427757e+01   1.4315840e+02   1.4315840e+02   1.4315840e+02   1.4315840e+02   1.4315840e+02   1.5322987e+02   1.5322987e+02   8.0384485e+02   8.0384485e+02   8.0384485e+02   2.8356888e+02   2.8356888e+02   8.5329010e+02   8.5329010e+02   6.3988965e+02   6.3988965e+02   6.3988965e+02   6.3988965e+02   9.2571375e+02   5.9259576e+02   5.9259576e+02   5.9259576e+02   5.9259576e+02   5.9259576e+02   8.9009460e+02   8.9009460e+02   9.0233740e+02   9.0233740e+02   9.0233740e+02   9.0233740e+02   9.0233740e+02   9.0233740e+02   6.2577411e+02   6.2577411e+02   6.2577411e+02   6.2577411e+02   8.0498132e+02   8.0498132e+02   8.0498132e+02   8.0498132e+02   8.0498132e+02   8.0498132e+02   8.0498132e+02   8.0498132e+02   7.2868065e+01   7.2868065e+01   6.9486633e+02   6.9486633e+02   6.9486633e+02   6.9486633e+02   6.9486633e+02   6.9486633e+02   7.2932825e+02   7.2932825e+02   7.2932825e+02   7.2932825e+02   7.0988239e+02   8.2436310e+02   8.2436310e+02   8.2454138e+02   8.2454138e+02   8.2454138e+02   8.2454138e+02   8.5221906e+02   9.7177905e+02   9.4906700e+01   9.4906700e+01   4.1451419e+02   5.0000650e+02   5.0000650e+02   5.4891980e+02   6.4797620e+02   6.4797620e+02   8.0960229e+02   8.0960229e+02   7.1594092e+02   8.2539423e+02   5.9268188e+02   5.9268188e+02   6.5749243e+02   6.5749243e+02   6.5749243e+02   6.0331818e+02   6.0331818e+02   6.2313373e+02   6.2313373e+02   8.3734467e+02   8.3734467e+02   8.3734467e+02   1.0021637e+03   1.0021637e+03   1.0165128e+03   9.3677618e+02   9.3677618e+02   9.3417450e+02   9.3417450e+02   1.9735390e+02   1.9735390e+02   2.9630264e+02   6.5627515e+02   6.5627515e+02   8.4577783e+02   9.2460034e+02   2.4465535e+02   4.2083545e+02   6.1625702e+02   6.1625702e+02   3.0312845e+02   5.8251538e+02   1.0355258e+03   1.0355258e+03   1.0120289e+03   9.7555402e+02   9.7555402e+02   8.0572375e+02   8.0572375e+02   8.0572375e+02   2.2902686e+02   2.2902686e+02   2.2902686e+02   7.1363934e+02   7.1363934e+02   7.1363934e+02   7.1363934e+02   7.1363934e+02   9.2470874e+02   9.2470874e+02   8.3734467e+02   8.3734467e+02   8.3734467e+02   8.3734467e+02   6.5383887e+02   6.9247089e+02   7.2211328e+02   8.7299628e+02   8.7299628e+02   3.1513858e+02   3.1513858e+02   3.1513858e+02   7.7891162e+02   7.7891162e+02   1.0133710e+03   4.3950949e+02   4.3950949e+02   9.8897205e+02   9.8897205e+02   1.8439552e+02   2.5590443e+02   2.6007745e+02   2.6310684e+02   2.6310684e+02   3.6810349e+02   4.4662793e+02   5.5165131e+02   5.5165131e+02   6.0921387e+02   7.0684509e+02   7.1056622e+02   7.3961469e+02   7.4018506e+02   7.4888867e+02   7.8903229e+02   7.9601910e+02   8.0732825e+02   8.3652057e+02   8.3652057e+02   8.3652057e+02   8.3652057e+02   8.6431451e+02   9.3431299e+02   9.4407239e+02   9.4927881e+02   9.4927881e+02   9.8990063e+02   9.9132513e+02   9.9132513e+02   5.5621368e+01   5.6409325e+01   9.5164421e+01   1.0632103e+02   1.0632103e+02   1.7613400e+02   2.0537082e+02   2.1203464e+02   2.1203464e+02   2.2189055e+02   2.5013429e+02   2.5328085e+02   2.5455515e+02   2.6270541e+02   2.6270541e+02   3.5491681e+02   4.2668637e+02   5.0732028e+02   5.6155420e+02   5.6155420e+02   6.4555267e+02   6.8003479e+02   6.9900006e+02   6.9861884e+02   6.9972412e+02   8.1524213e+02   8.2787531e+02   8.7097772e+02   8.9506036e+02   8.9506036e+02   8.9506036e+02   9.2940497e+02   9.3966119e+02   9.4967780e+02   1.0747050e+03   1.0747050e+03   1.0760519e+03   9.4906700e+01   1.4532520e+02   2.2130373e+02   2.6095334e+02   2.6302649e+02   2.6770453e+02   2.7048083e+02   2.7893088e+02   2.8608447e+02   3.2358978e+02   3.4694843e+02   4.2231110e+02   4.2231110e+02   4.2541324e+02   4.2705002e+02   4.3179654e+02   4.3490274e+02   4.3490274e+02   4.4049637e+02   4.4195856e+02   4.6225208e+02   4.9137143e+02   5.1524402e+02   5.4195001e+02   5.6682965e+02   5.6706805e+02   5.7367365e+02   5.7763843e+02   6.0331818e+02   6.4994421e+02   6.4994421e+02   6.4994421e+02   6.4994421e+02   6.6224347e+02   7.1722339e+02   7.2597168e+02   7.2597168e+02   7.3469489e+02   7.5407489e+02   7.6536633e+02   8.2706415e+02   8.2706415e+02   9.1990088e+02   9.3417450e+02   9.5135663e+02   1.0847832e+03   1.6895340e+02   1.6895340e+02   2.1139264e+02   2.1812584e+02   2.2095457e+02   2.8433130e+02   2.9830099e+02   2.9830099e+02   3.0632565e+02   3.2121796e+02   3.5624551e+02   3.7008109e+02   3.7178955e+02   4.2748935e+02   4.2863901e+02   4.9396146e+02   4.9734009e+02   5.7000641e+02   5.6963885e+02   5.6963885e+02   5.7479993e+02   5.8750739e+02   5.9067908e+02   5.9636304e+02   5.9636304e+02   5.9636304e+02   5.9636304e+02   6.5275397e+02   6.8141980e+02   6.8148450e+02   7.8163123e+02   9.2749011e+02   9.8353271e+02   9.8767456e+02   1.0346967e+03   1.1718717e+02   1.5143286e+02   2.0021883e+02   2.3934360e+02   2.6169379e+02   2.6197278e+02   2.6197278e+02   2.8107724e+02   2.8107724e+02   3.5933829e+02   4.5330017e+02   4.7511514e+02   5.6157281e+02   5.7055981e+02   6.0456665e+02   6.2798505e+02   6.2798505e+02   7.8811572e+02   8.4577783e+02   9.9015314e+02   6.4500488e+01   6.4500488e+01   6.4500488e+01   8.9662460e+01   1.9551721e+02   1.9551721e+02   1.9551721e+02   1.9551721e+02   2.4944051e+02   2.4944051e+02   2.4944051e+02   3.3245120e+02   3.3299182e+02   3.5749109e+02   3.8320050e+02   4.7037387e+02   5.5676819e+02   5.5676819e+02   6.3747302e+02   6.3747302e+02   6.6160712e+02   8.0298047e+02   9.0224268e+02   1.2178747e+02   1.2178747e+02   1.5306435e+02   2.4045042e+02   4.0352032e+02   4.0352032e+02   4.9079819e+02   4.9079819e+02   5.3064307e+02   5.3064307e+02   5.8335614e+02   6.4944727e+02   6.4944727e+02   7.1389630e+02   7.1389630e+02   8.3914276e+02   8.3914276e+02   5.3869362e+01   1.2251411e+02   3.9650998e+02   5.5291602e+02   8.3667480e+02   8.3667480e+02   1.3190965e+02   2.9524283e+02   6.8909192e+02   6.8909192e+02   6.8909192e+02   7.7630566e+02   7.7630566e+02   8.7194049e+02   3.8040652e+02   4.8083389e+02   6.6595850e+02   6.6595850e+02   7.4931989e+02   7.4931989e+02   7.4931989e+02   7.4931989e+02   5.4666949e+02   5.4666949e+02   9.6394562e+02
         2.2680025e+02   2.2680025e+02   5.7346375e+02   5.7346375e+02   5.7346375e+02   6.4287518e+02   6.4287518e+02   6.4287518e+02   4.7063483e+02   4.7063483e+02   4.7063483e+02   5.5712146e+02   6.5956616e+02   6.5956616e+02   6.5956616e+02   6.5956616e+02   6.1563495e+02   6.1563495e+02   6.1563495e+02   6.1563495e+02   4.3621188e+02   4.3621188e+02   1.8226372e+02   1.8226372e+02   1.8226372e+02   1.8226372e+02   1.8226372e+02   2.0570372e+02   3.6796130e+02   3.6796130e+02   3.6796130e+02   3.6796130e+02   2.9162015e+02   2.9162015e+02   2.4154445e+02   2.4154445e+02   3.9031677e+02   3.9031677e+02   3.9031677e+02   2.8041818e+02   2.8041818e+02   2.8041818e+02   3.0546442e+02   3.0546442e+02   3.0546442e+02   3.8128394e+02   3.8128394e+02   5.5252142e+02   5.5252142e+02   5.5252142e+02   5.3629144e+02   5.3629144e+02   5.6434979e+02   5.6434979e+02   5.6434979e+02   5.6283240e+02   5.6283240e+02   5.6283240e+02   6.5573169e+02   6.5573169e+02   6.5573169e+02   6.5573169e+02   3.3994864e+02   3.8794794e+02   3.8794794e+02   3.8794794e+02   3.8794794e+02   3.8794794e+02   3.9542337e+02   3.9542337e+02   3.9542337e+02   3.1765652e+02   3.1765652e+02   3.1765652e+02   6.4446027e+02   6.4446027e+02   6.4446027e+02   6.4446027e+02   6.4446027e+02   6.1468176e+02   6.1468176e+02   6.1468176e+02   6.1468176e+02   6.1468176e+02   6.1468176e+02   3.2926053e+02   3.2926053e+02   3.2926053e+02   3.2926053e+02   1.9102946e+02   1.9102946e+02   1.9102946e+02   1.9888643e+02   1.9888643e+02   1.9888643e+02   1.9618127e+02   1.9618127e+02   1.9618127e+02   1.9618127e+02   2.9710367e+02   2.9710367e+02   2.4633592e+02   2.4633592e+02   6.9164539e+02   6.9164539e+02   6.9164539e+02   6.9164539e+02   6.9490668e+02   6.9490668e+02   5.5246576e+02   5.5246576e+02   3.0634766e+02   3.0634766e+02   4.7479141e+02   4.7479141e+02   4.7479141e+02   4.9069113e+02   4.9069113e+02   4.9069113e+02   3.7859479e+02   3.7859479e+02   3.7859479e+02   5.8917126e+02   5.8917126e+02   3.0847003e+02   3.0847003e+02   3.0847003e+02   3.5115479e+02   3.5115479e+02   5.9877606e+02   5.9877606e+02   5.9877606e+02   5.9877606e+02   5.9877606e+02   5.9877606e+02   5.9877606e+02   3.6824496e+02   3.6824496e+02   3.6252502e+02   3.6252502e+02   3.5605270e+02   3.5605270e+02   3.3940079e+02   3.3940079e+02   3.3940079e+02   3.3495905e+02   3.3495905e+02   3.3495905e+02   4.5876285e+02   4.5876285e+02   3.1126688e+02   3.1126688e+02   3.1126688e+02   3.1126688e+02   3.2451440e+02   3.2451440e+02   2.9341702e+02   2.9341702e+02   2.5218010e+02   2.5218010e+02   2.5218010e+02   2.5218010e+02   2.5218010e+02   2.5218010e+02   3.9964975e+02   3.9964975e+02   3.9964975e+02   3.9964975e+02   6.2139709e+02   6.2139709e+02   4.8415796e+02   4.8415796e+02   3.4009686e+02   3.4009686e+02   3.4009686e+02   2.8247580e+02   2.8247580e+02   2.8247580e+02   1.4153859e+02   1.4153859e+02   3.5918811e+02   3.5918811e+02   3.5918811e+02   5.3717133e+02   5.3717133e+02   3.8940900e+02   3.8940900e+02   5.2757111e+02   5.2757111e+02   5.1948914e+02   5.1948914e+02   5.1948914e+02   5.1948914e+02   3.8972958e+02   3.8972958e+02   3.4740717e+02   3.4740717e+02   5.1273352e+02   5.1273352e+02   6.3388605e+02   6.3388605e+02   6.3388605e+02   6.3388605e+02   6.3388605e+02   6.3388605e+02   5.2403857e+02   5.2403857e+02   3.5113562e+02   3.5113562e+02   3.5113562e+02   5.4851678e+02   5.4851678e+02   5.4851678e+02   5.4851678e+02   5.4851678e+02   5.4851678e+02   5.4851678e+02   5.4851678e+02   5.4851678e+02   5.9298279e+02   5.9298279e+02   3.7804617e+02   3.7804617e+02   4.7645285e+02   4.7645285e+02   3.7537537e+02   3.7537537e+02   4.1833368e+02   4.1833368e+02   4.7850629e+02   4.7850629e+02   4.7850629e+02   4.9567780e+02   4.9567780e+02   4.9567780e+02   5.7260687e+02   5.7260687e+02   5.7260687e+02   5.7260687e+02   5.7260687e+02   5.7260687e+02   5.2660553e+02   5.2660553e+02   5.2660553e+02   5.2660553e+02   3.8191782e+02   3.8191782e+02   4.0202856e+02   4.0202856e+02   4.0202856e+02   4.0202856e+02   4.0202856e+02   4.0202856e+02   4.7681381e+02   4.7681381e+02   4.7681381e+02   5.9398407e+02   5.9398407e+02   5.9398407e+02   4.5445416e+02   4.5445416e+02   3.6917389e+02   3.6917389e+02   3.6917389e+02   3.7975888e+02   3.7975888e+02   3.7975888e+02   5.4102258e+02   5.4102258e+02   5.4300555e+02   5.4300555e+02   5.4300555e+02   4.0749045e+02   2.4523589e+02   2.4523589e+02   2.8431464e+02   5.0463257e+02   5.0463257e+02   5.0463257e+02   5.0463257e+02   4.3166656e+02   1.9339375e+02   1.9339375e+02   1.9339375e+02   1.9339375e+02   1.9339375e+02   2.8768506e+02   2.8768506e+02   6.0390350e+02   6.0390350e+02   6.2366125e+02   6.2366125e+02   5.0692828e+02   5.0692828e+02   5.0692828e+02   5.0692828e+02   4.9607208e+02   4.9607208e+02   4.9607208e+02   4.9607208e+02   4.9607208e+02   6.3729736e+02   6.3729736e+02   4.0816406e+02   4.0816406e+02   4.0816406e+02   3.4874628e+02   3.4874628e+02   4.7885257e+02   4.7885257e+02   4.9790857e+02   4.9790857e+02   4.9790857e+02   4.9790857e+02   3.3679660e+02   6.0610193e+02   6.0610193e+02   6.0610193e+02   6.0610193e+02   6.0610193e+02   3.0307870e+02   3.0307870e+02   2.1459784e+02   2.1459784e+02   2.1459784e+02   2.1459784e+02   2.1459784e+02   2.1459784e+02   5.5326898e+02   5.5326898e+02   5.5326898e+02   5.5326898e+02   2.9885693e+02   2.9885693e+02   2.9885693e+02   2.9885693e+02   2.9885693e+02   2.9885693e+02   2.9885693e+02   2.9885693e+02   4.9514890e+02   4.9514890e+02   5.5982397e+02   5.5982397e+02   5.5982397e+02   5.5982397e+02   5.5982397e+02   5.5982397e+02   6.1266217e+02   6.1266217e+02   6.1266217e+02   6.1266217e+02   3.3225995e+02   4.4024359e+02   4.4024359e+02   3.4976563e+02   3.4976563e+02   3.4976563e+02   3.4976563e+02   2.9364273e+02   2.4907138e+02   5.2814032e+02   5.2814032e+02   5.4736932e+02   4.5377481e+02   4.5377481e+02   4.8164459e+02   4.2675378e+02   4.2675378e+02   7.3830310e+02   7.3830310e+02   4.0011215e+02   7.1156085e+02   6.3158167e+02   6.3158167e+02   6.3542950e+02   6.3542950e+02   6.3542950e+02   3.9045535e+02   3.9045535e+02   4.2274335e+02   4.2274335e+02   4.9555374e+02   4.9555374e+02   4.9555374e+02   6.0468152e+02   6.0468152e+02   6.1998993e+02   3.5206628e+02   3.5206628e+02   1.9442775e+02   1.9442775e+02   3.1698099e+02   3.1698099e+02   1.8623615e+02   5.7413477e+02   5.7413477e+02   2.7993561e+02   3.0343869e+02   3.6701196e+02   6.2231055e+02   4.0052875e+02   4.0052875e+02   5.9332117e+02   5.4312854e+02   6.2366125e+02   6.2366125e+02   6.3350146e+02   3.0211914e+02   3.0211914e+02   6.0242914e+02   6.0242914e+02   6.0242914e+02   6.4525861e+02   6.4525861e+02   6.4525861e+02   5.7078033e+02   5.7078033e+02   5.7078033e+02   5.7078033e+02   5.7078033e+02   6.9925854e+02   6.9925854e+02   4.9555374e+02   4.9555374e+02   4.9555374e+02   4.9555374e+02   6.1557678e+02   3.8360333e+02   5.3053363e+02   3.2723434e+02   3.2723434e+02   6.2718390e+02   6.2718390e+02   6.2718390e+02   5.0536703e+02   5.0536703e+02   5.0178125e+02   5.6323767e+02   5.6323767e+02   2.4919884e+02   2.4919884e+02   4.9886646e+02   1.8280174e+02   4.5400513e+02   5.5399060e+02   5.5399060e+02   5.7690356e+02   3.0439261e+02   6.0629132e+02   6.0629132e+02   5.4687366e+02   3.0199985e+02   3.6568930e+02   1.8524414e+02   4.7111664e+02   7.6641937e+02   3.0732980e+02   1.8681367e+02   4.1777869e+02   3.5502460e+02   3.5502460e+02   3.5502460e+02   3.5502460e+02   2.9935529e+02   3.1684641e+02   3.5061066e+02   4.5932623e+02   4.5932623e+02   4.1024277e+02   4.1665906e+02   4.1665906e+02   5.8206329e+02   6.8188342e+02   2.9850894e+02   4.8518936e+02   4.8518936e+02   2.7976282e+02   5.4600439e+02   6.2350610e+02   6.2350610e+02   3.1846625e+02   4.6843463e+02   2.1586731e+02   3.1798560e+02   4.0944760e+02   4.0944760e+02   3.6184949e+02   4.6510983e+02   6.8510742e+02   4.4553314e+02   4.4553314e+02   2.7251065e+02   7.3814069e+02   3.2197748e+02   5.0830615e+02   3.1183612e+02   3.8457254e+02   7.4221777e+02   7.4009271e+02   5.0069019e+02   5.0069019e+02   5.0069019e+02   7.5066351e+02   2.9341702e+02   5.0807031e+02   5.5180975e+02   5.5180975e+02   6.0972888e+02   5.2814032e+02   2.1595482e+02   1.8602695e+02   1.9114186e+02   3.8289279e+02   5.0339471e+02   2.0664575e+02   1.9690077e+02   7.2687311e+02   5.3380927e+02   4.4948444e+02   3.2500128e+02   3.2500128e+02   6.1182208e+02   2.4892911e+02   3.1549863e+02   5.4003845e+02   5.4003845e+02   3.1473483e+02   3.2501706e+02   5.4113464e+02   5.5802014e+02   5.4349011e+02   5.4542548e+02   5.4705042e+02   5.7075812e+02   5.0248587e+02   3.8636713e+02   3.9045535e+02   6.0262683e+02   6.0262683e+02   6.0262683e+02   6.0262683e+02   4.7631796e+02   3.6824496e+02   3.6132501e+02   3.6132501e+02   3.6252502e+02   3.5605270e+02   1.6637305e+02   4.9657959e+02   4.9657959e+02   7.2168738e+02   1.9442775e+02   6.4884802e+02   6.8490576e+02   7.0819855e+02   7.0819855e+02   2.9660239e+02   3.0601019e+02   3.6817923e+02   4.3750919e+02   1.9826724e+02   1.9826724e+02   3.0662570e+02   4.1833368e+02   6.1642456e+02   6.0855518e+02   4.3080573e+02   5.3924274e+02   4.8104810e+02   4.8785883e+02   6.1462042e+02   3.9501184e+02   5.2561145e+02   5.2561145e+02   4.9110138e+02   4.8962164e+02   3.0322632e+02   6.8534796e+02   6.8534796e+02   6.8534796e+02   6.8534796e+02   4.1725470e+02   3.8191782e+02   5.1432770e+02   3.6838733e+02   2.6581372e+02   6.8207788e+02   2.1298267e+02   6.2730353e+02   5.6467499e+02   5.9403912e+02   3.2859979e+02   2.8801639e+02   3.0655505e+02   7.0353149e+02   7.0353149e+02   6.9671967e+02   6.9671967e+02   4.0321274e+02   4.8333853e+02   5.3848187e+02   4.8882144e+02   5.5945551e+02   4.0099847e+02   5.5946368e+02   5.5946368e+02   4.0202856e+02   2.7993561e+02   6.4120837e+02   4.9519510e+02   4.9519510e+02   4.9519510e+02   6.6188611e+02   5.8322186e+02   5.8322186e+02   5.8322186e+02   5.8322186e+02   5.5895374e+02   5.5895374e+02   5.5895374e+02   4.0608939e+02   4.3299023e+02   4.3780615e+02   4.1878680e+02   3.3100275e+02   5.2440991e+02   5.2440991e+02   3.5029541e+02   3.5029541e+02   4.6017804e+02   3.6704272e+02   6.8241608e+02   6.3616449e+02   6.3616449e+02   2.1636844e+02   2.8618759e+02   6.0544958e+02   6.0544958e+02   4.5374692e+02   4.5374692e+02   4.5607126e+02   4.5607126e+02   4.5642639e+02   4.4112473e+02   4.4112473e+02   4.6255371e+02   4.6255371e+02   3.3620975e+02   3.3620975e+02   6.1261292e+02   5.5385913e+02   5.7900214e+02   3.7860309e+02   3.0397043e+02   3.0397043e+02   2.4895998e+02   4.3300626e+02   4.4624588e+02   4.4624588e+02   4.4624588e+02   4.6675909e+02   4.6675909e+02   3.5110541e+02   4.3760785e+02   5.1028629e+02   2.4897133e+02   2.4897133e+02   4.9651117e+02   4.9651117e+02   4.9651117e+02   4.9651117e+02   2.6790567e+02   2.6790567e+02   4.6517468e+02];
    Y = [-5.3464257e+00  -5.3464257e+00  -1.4800581e+00  -1.4800581e+00  -1.4800581e+00  -1.3380923e+00  -1.3380923e+00  -1.3380923e+00  -2.5260177e-02  -2.5260177e-02  -2.5260177e-02   5.8702743e-01   1.4395416e+00   1.4395416e+00   1.4395416e+00   1.4395416e+00   1.9977647e+00   1.9977647e+00   1.9977647e+00   1.9977647e+00   2.5506145e+00   2.5506145e+00   4.0405336e+00   4.0405336e+00   4.0405336e+00   4.0405336e+00   4.0405336e+00   4.3214002e+00   4.2781035e+00   4.2781035e+00   4.2781035e+00   4.2781035e+00   4.8308774e+00   4.8308774e+00   4.8152447e+00   4.8152447e+00  -6.4738937e+00  -6.4738937e+00  -6.4738937e+00  -4.0029842e+00  -4.0029842e+00  -4.0029842e+00  -4.2153724e+00  -4.2153724e+00  -4.2153724e+00  -4.2450625e+00  -4.2450625e+00  -2.3042115e+00  -2.3042115e+00  -2.3042115e+00  -2.4381559e+00  -2.4381559e+00  -1.0562298e+00  -1.0562298e+00  -1.0562298e+00  -8.2340025e-01  -8.2340025e-01  -8.2340025e-01   2.2768871e-01   2.2768871e-01   2.2768871e-01   2.2768871e-01   6.4786228e-01   8.5900950e-01   8.5900950e-01   8.5900950e-01   8.5900950e-01   8.5900950e-01   9.3294578e-01   9.3294578e-01   9.3294578e-01   1.3027175e+00   1.3027175e+00   1.3027175e+00   1.4186233e+00   1.4186233e+00   1.4186233e+00   1.4186233e+00   1.4186233e+00   1.4997575e+00   1.4997575e+00   1.4997575e+00   1.4997575e+00   1.4997575e+00   1.4997575e+00   3.7688119e+00   3.7688119e+00   3.7688119e+00   3.7688119e+00   4.3368810e+00   4.3368810e+00   4.3368810e+00   4.4602513e+00   4.4602513e+00   4.4602513e+00   4.6631843e+00   4.6631843e+00   4.6631843e+00   4.6631843e+00   4.8806101e+00   4.8806101e+00   4.8491330e+00   4.8491330e+00   3.6488607e+00   3.6488607e+00   3.6488607e+00   3.6488607e+00   4.4709097e+00   4.4709097e+00  -5.4082177e+00  -5.4082177e+00  -4.3028729e+00  -4.3028729e+00  -3.2363748e+00  -3.2363748e+00  -3.2363748e+00  -2.3170869e+00  -2.3170869e+00  -2.3170869e+00  -1.6648717e+00  -1.6648717e+00  -1.6648717e+00  -9.3721699e-01  -9.3721699e-01   1.1638279e+00   1.1638279e+00   1.1638279e+00   1.5677062e+00   1.5677062e+00   1.4492641e+00   1.4492641e+00   1.4492641e+00   1.4492641e+00   1.4492641e+00   1.4492641e+00   1.4492641e+00   1.8056504e+00   1.8056504e+00   2.0127917e+00   2.0127917e+00   2.2483328e+00   2.2483328e+00   2.3516450e+00   2.3516450e+00   2.3516450e+00   2.4486638e+00   2.4486638e+00   2.4486638e+00   3.4307622e+00   3.4307622e+00   4.6347805e+00   4.6347805e+00   4.6347805e+00   4.6347805e+00   4.9157888e+00   4.9157888e+00   4.6823890e+00   4.6823890e+00   4.8850173e+00   4.8850173e+00   4.8850173e+00   4.8850173e+00   4.8850173e+00   4.8850173e+00   6.2952582e+00   6.2952582e+00   6.2952582e+00   6.2952582e+00  -4.2714064e+00  -4.2714064e+00  -5.3160264e+00  -5.3160264e+00  -4.5190699e+00  -4.5190699e+00  -4.5190699e+00  -4.0871357e+00  -4.0871357e+00  -4.0871357e+00  -3.0343800e+00  -3.0343800e+00   4.6220800e-01   4.6220800e-01   4.6220800e-01   4.4610055e-01   4.4610055e-01   6.0908865e-01   6.0908865e-01   5.3296445e-01   5.3296445e-01   1.0522447e+00   1.0522447e+00   1.0522447e+00   1.0522447e+00   1.2756848e+00   1.2756848e+00   1.4469153e+00   1.4469153e+00   1.6713305e+00   1.6713305e+00   1.4800803e+00   1.4800803e+00   1.4800803e+00   1.4800803e+00   1.4800803e+00   1.4800803e+00   2.0062327e+00   2.0062327e+00   2.4182145e+00   2.4182145e+00   2.4182145e+00   2.6553591e+00   2.6553591e+00   2.6553591e+00   2.6553591e+00   2.6553591e+00   2.6553591e+00   2.6553591e+00   2.6553591e+00   2.6553591e+00  -5.0450582e+00  -5.0450582e+00  -6.4684563e+00  -6.4684563e+00  -4.6656535e+00  -4.6656535e+00  -4.6768436e+00  -4.6768436e+00  -2.3246138e+00  -2.3246138e+00  -2.4172582e+00  -2.4172582e+00  -2.4172582e+00  -2.4235029e+00  -2.4235029e+00  -2.4235029e+00   3.6476968e-01   3.6476968e-01   3.6476968e-01   3.6476968e-01   3.6476968e-01   3.6476968e-01   1.1028486e+00   1.1028486e+00   1.1028486e+00   1.1028486e+00   1.3993177e+00   1.3993177e+00   2.7971463e+00   2.7971463e+00   2.7971463e+00   2.7971463e+00   2.7971463e+00   2.7971463e+00   5.4727576e+00   5.4727576e+00   5.4727576e+00   4.8368565e+00   4.8368565e+00   4.8368565e+00  -2.3170054e+00  -2.3170054e+00  -1.9287228e+00  -1.9287228e+00  -1.9287228e+00  -1.5857237e+00  -1.5857237e+00  -1.5857237e+00  -2.2041705e-01  -2.2041705e-01   2.9715271e-02   2.9715271e-02   2.9715271e-02   4.2477934e-01   7.8428708e-01   7.8428708e-01   1.0980071e+00   2.0359733e+00   2.0359733e+00   2.0359733e+00   2.0359733e+00   3.2218453e+00   4.5332297e+00   4.5332297e+00   4.5332297e+00   4.5332297e+00   4.5332297e+00   4.3160034e+00   4.3160034e+00   4.4193722e+00   4.4193722e+00   4.7935268e+00   4.7935268e+00  -5.4171336e+00  -5.4171336e+00  -5.4171336e+00  -5.4171336e+00  -4.8164120e+00  -4.8164120e+00  -4.8164120e+00  -4.8164120e+00  -4.8164120e+00  -3.9254152e+00  -3.9254152e+00   2.9299493e+00   2.9299493e+00   2.9299493e+00  -2.6135398e+00  -2.6135398e+00   3.4847988e+00   3.4847988e+00   8.9035877e-01   8.9035877e-01   8.9035877e-01   8.9035877e-01   5.2340063e+00   4.1379678e-01   4.1379678e-01   4.1379678e-01   4.1379678e-01   4.1379678e-01   4.1633597e+00   4.1633597e+00   4.5508252e+00   4.5508252e+00   4.5508252e+00   4.5508252e+00   4.5508252e+00   4.5508252e+00   7.5472371e-01   7.5472371e-01   7.5472371e-01   7.5472371e-01   3.2286035e+00   3.2286035e+00   3.2286035e+00   3.2286035e+00   3.2286035e+00   3.2286035e+00   3.2286035e+00   3.2286035e+00  -5.7497833e+00  -5.7497833e+00   1.5005107e+00   1.5005107e+00   1.5005107e+00   1.5005107e+00   1.5005107e+00   1.5005107e+00   1.7696512e+00   1.7696512e+00   1.7696512e+00   1.7696512e+00   1.5626048e+00   3.3366737e+00   3.3366737e+00   3.4395833e+00   3.4395833e+00   3.4395833e+00   3.4395833e+00   4.1937426e+00   4.9799182e+00  -5.2528784e+00  -5.2528784e+00  -1.3681166e+00  -4.3818014e-01  -4.3818014e-01  -1.9101922e-02   1.1027439e+00   1.1027439e+00   2.2822704e+00   2.2822704e+00   1.9410652e+00   2.4662923e+00   3.9581758e-01   3.9581758e-01   1.0295198e+00   1.0295198e+00   1.0295198e+00   5.1582522e-01   5.1582522e-01   7.8252000e-01   7.8252000e-01   3.2874203e+00   3.2874203e+00   3.2874203e+00   4.5802442e+00   4.5802442e+00   4.6288790e+00   5.4970677e+00   5.4970677e+00   4.7092900e+00   4.7092900e+00  -4.3928880e+00  -4.3928880e+00  -3.4273056e+00   1.0764759e+00   1.0764759e+00   4.1532630e+00   4.4577506e+00  -3.3693377e+00  -1.2976914e+00   6.7534616e-01   6.7534616e-01  -2.6046899e+00   3.0720320e-01   4.7935268e+00   4.7935268e+00   4.6480425e+00   5.7323357e+00   5.7323357e+00   2.6329390e+00   2.6329390e+00   2.6329390e+00  -3.0987074e+00  -3.0987074e+00  -3.0987074e+00   1.6754485e+00   1.6754485e+00   1.6754485e+00   1.6754485e+00   1.6754485e+00   3.4323199e+00   3.4323199e+00   3.2874203e+00   3.2874203e+00   3.2874203e+00   3.2874203e+00   1.0019481e+00   1.5530266e+00   1.8644069e+00   4.2247759e+00   4.2247759e+00  -2.3605379e+00  -2.3605379e+00  -2.3605379e+00   2.6287020e+00   2.6287020e+00   5.4451203e+00  -1.1769728e+00  -1.1769728e+00   5.6217985e+00   5.6217985e+00  -4.4620765e+00  -3.6323392e+00  -3.7711034e+00  -3.1951481e+00  -3.1951481e+00  -1.9823322e+00  -1.1485728e+00   7.5027349e-03   7.5027349e-03   5.7802312e-01   1.4236713e+00   1.7093454e+00   4.1664927e+00   2.0563971e+00   1.6724094e+00   4.1784990e+00   5.5659025e+00   2.9324352e+00   3.5672305e+00   3.5672305e+00   3.5672305e+00   3.5672305e+00   4.3537696e+00   4.8267995e+00   5.7458235e+00   4.9827355e+00   4.9827355e+00   5.9579770e+00   5.9547322e+00   5.9547322e+00  -5.2392361e+00  -4.5641815e+00  -8.2506307e+00  -5.5707949e+00  -5.5707949e+00  -4.1971472e+00  -3.9121091e+00  -3.3161865e+00  -3.3161865e+00  -3.8819101e+00  -3.7469420e+00  -3.8061339e+00  -3.1529598e+00  -3.2556527e+00  -3.2556527e+00  -1.8119447e+00  -1.0452876e+00  -3.8061772e-01   8.9542505e-02   8.9542505e-02   8.2729480e-01   1.1215532e+00   1.4003608e+00   1.5041039e+00   1.3846302e+00   3.1577323e+00   2.4140745e+00   2.8090499e+00   3.9649253e+00   3.9649253e+00   3.9649253e+00   3.2785018e+00   4.6823890e+00   4.7397802e+00   5.7303389e+00   5.7303389e+00   5.3233303e+00  -5.2528784e+00  -4.7554364e+00  -3.8968495e+00  -3.6314108e+00  -3.0689179e+00  -3.3448373e+00  -3.6978717e+00  -3.5868742e+00  -2.2625688e+00  -2.5288115e+00  -2.1678867e+00  -1.3984117e+00  -1.3984117e+00  -1.2592254e+00  -1.2934325e+00  -1.2969004e+00  -1.1061796e+00  -1.1061796e+00  -1.2259598e+00  -1.2266893e+00  -1.7264755e+00  -7.3000629e-01  -3.4366293e-01  -8.6506137e-02   1.5376854e-01   1.6391354e-01   2.0112261e-01   2.2395818e-01   5.1582522e-01   9.8570338e-01   9.8570338e-01   9.8570338e-01   9.8570338e-01   1.1332156e+00   1.8056504e+00   1.8976183e+00   1.8976183e+00   2.0127917e+00   2.2483328e+00   2.9185613e+00   3.1870745e+00   3.1870745e+00   3.1906534e+00   4.7092900e+00   3.9091839e+00   4.9441763e+00  -3.3110808e+00  -3.3110808e+00  -3.8771430e+00  -3.9795836e+00  -3.9807345e+00  -2.9884783e+00  -3.5109127e+00  -3.5109127e+00  -2.3361427e+00  -2.3246138e+00  -1.9203572e+00  -1.8792746e+00  -1.7847361e+00  -1.2085416e+00  -1.0494719e+00  -9.2456951e-01  -5.2492323e-01   1.6233381e-01   1.7445232e-01   1.7445232e-01   2.0633030e-01   3.1925724e-01   4.1590737e-01   4.5220561e-01   4.5220561e-01   4.5220561e-01   4.5220561e-01   1.1430046e+00   1.3993177e+00   1.3807597e+00   2.7764893e+00   4.4441448e+00   4.0724437e+00   5.2286391e+00   4.6896661e+00  -4.6805277e+00  -4.0595895e+00  -4.3390597e+00  -3.2951491e+00  -2.9670990e+00  -2.5420459e+00  -2.5420459e+00  -2.4076434e+00  -2.4076434e+00  -1.8233650e+00  -8.4512911e-01  -7.2644874e-01   9.0860107e-02   2.0039367e-01   5.3276710e-01   7.9259871e-01   7.9259871e-01   2.7971463e+00   4.1532630e+00   4.2974428e+00  -5.9353562e+00  -5.9353562e+00  -5.9353562e+00  -4.2570658e+00  -3.8329868e+00  -3.8329868e+00  -3.8329868e+00  -3.8329868e+00  -3.3365401e+00  -3.3365401e+00  -3.3365401e+00  -2.1054600e+00  -2.2008792e+00  -1.9543494e+00  -1.5931995e+00  -8.7095902e-01   5.3653414e-02   5.3653414e-02   8.3019511e-01   8.3019511e-01   1.2295139e+00   2.8196890e+00   3.2723829e+00  -4.1773620e+00  -4.1773620e+00  -4.6945732e+00  -3.2435072e+00  -1.5429086e+00  -1.5429086e+00  -5.1602869e-01  -5.1602869e-01  -1.7561147e-01  -1.7561147e-01   2.7332817e-01   1.0426883e+00   1.0426883e+00   1.8282746e+00   1.8282746e+00   3.6959230e+00   3.6959230e+00  -5.1075630e+00  -4.9601552e+00  -1.6547231e+00   1.5097241e-02   3.8896855e+00   3.8896855e+00  -5.9500930e+00  -2.8342710e+00   1.5620075e+00   1.5620075e+00   1.5620075e+00   2.6680398e+00   2.6680398e+00   3.9928927e+00  -1.5750125e+00  -6.8144085e-01   1.0206334e+00   1.0206334e+00   2.2259312e+00   2.2259312e+00   2.2259312e+00   2.2259312e+00  -4.7534921e-02  -4.7534921e-02   5.5786723e+00
         -2.5570719e+00  -2.5570719e+00   1.5864555e+00   1.5864555e+00   1.5864555e+00   2.1073945e+00   2.1073945e+00   2.1073945e+00   3.8703132e-01   3.8703132e-01   3.8703132e-01   1.3432230e+00   2.2070286e+00   2.2070286e+00   2.2070286e+00   2.2070286e+00   1.8900168e+00   1.8900168e+00   1.8900168e+00   1.8900168e+00   1.1896177e-01   1.1896177e-01  -3.0859287e+00  -3.0859287e+00  -3.0859287e+00  -3.0859287e+00  -3.0859287e+00  -2.9036535e+00  -7.3932676e-01  -7.3932676e-01  -7.3932676e-01  -7.3932676e-01  -1.6400839e+00  -1.6400839e+00  -2.1695407e+00  -2.1695407e+00  -5.1784765e-01  -5.1784765e-01  -5.1784765e-01  -1.6561574e+00  -1.6561574e+00  -1.6561574e+00  -1.4494712e+00  -1.4494712e+00  -1.4494712e+00  -5.6115660e-01  -5.6115660e-01   1.3989734e+00   1.3989734e+00   1.3989734e+00   1.2845697e+00   1.2845697e+00   1.4625603e+00   1.4625603e+00   1.4625603e+00   1.4386359e+00   1.4386359e+00   1.4386359e+00   2.1317866e+00   2.1317866e+00   2.1317866e+00   2.1317866e+00  -8.3423980e-01  -3.8656461e-01  -3.8656461e-01  -3.8656461e-01  -3.8656461e-01  -3.8656461e-01  -3.1527762e-01  -3.1527762e-01  -3.1527762e-01  -1.0109762e+00  -1.0109762e+00  -1.0109762e+00   2.0938000e+00   2.0938000e+00   2.0938000e+00   2.0938000e+00   2.0938000e+00   1.8639152e+00   1.8639152e+00   1.8639152e+00   1.8639152e+00   1.8639152e+00   1.8639152e+00  -1.2630313e+00  -1.2630313e+00  -1.2630313e+00  -1.2630313e+00  -2.9865350e+00  -2.9865350e+00  -2.9865350e+00  -2.8944085e+00  -2.8944085e+00  -2.8944085e+00  -2.8635236e+00  -2.8635236e+00  -2.8635236e+00  -2.8635236e+00  -1.5998442e+00  -1.5998442e+00  -2.1058967e+00  -2.1058967e+00   2.4676029e+00   2.4676029e+00   2.4676029e+00   2.4676029e+00   2.4875940e+00   2.4875940e+00   1.3936882e+00   1.3936882e+00  -1.4349160e+00  -1.4349160e+00   6.0132881e-01   6.0132881e-01   6.0132881e-01   7.5864580e-01   7.5864580e-01   7.5864580e-01  -4.3562354e-01  -4.3562354e-01  -4.3562354e-01   1.7708910e+00   1.7708910e+00  -1.0593631e+00  -1.0593631e+00  -1.0593631e+00  -7.5800344e-01  -7.5800344e-01   1.7273342e+00   1.7273342e+00   1.7273342e+00   1.7273342e+00   1.7273342e+00   1.7273342e+00   1.7273342e+00  -6.2493786e-01  -6.2493786e-01  -6.9301116e-01  -6.9301116e-01  -7.7224954e-01  -7.7224954e-01  -9.4053043e-01  -9.4053043e-01  -9.4053043e-01  -9.9115194e-01  -9.9115194e-01  -9.9115194e-01   3.9528392e-01   3.9528392e-01  -1.4085206e+00  -1.4085206e+00  -1.4085206e+00  -1.4085206e+00  -1.3011024e+00  -1.3011024e+00  -1.5957948e+00  -1.5957948e+00  -2.0824786e+00  -2.0824786e+00  -2.0824786e+00  -2.0824786e+00  -2.0824786e+00  -2.0824786e+00  -3.7221265e-01  -3.7221265e-01  -3.7221265e-01  -3.7221265e-01   1.9145631e+00   1.9145631e+00   7.3635711e-01   7.3635711e-01  -1.0670978e+00  -1.0670978e+00  -1.0670978e+00  -1.6265501e+00  -1.6265501e+00  -1.6265501e+00  -3.8145300e+00  -3.8145300e+00  -6.4000286e-01  -6.4000286e-01  -6.4000286e-01   1.0776930e+00   1.0776930e+00  -3.6066053e-01  -3.6066053e-01   9.7149412e-01   9.7149412e-01   9.0445928e-01   9.0445928e-01   9.0445928e-01   9.0445928e-01  -3.7434952e-01  -3.7434952e-01  -7.8043981e-01  -7.8043981e-01   9.3304640e-01   9.3304640e-01   2.0084959e+00   2.0084959e+00   2.0084959e+00   2.0084959e+00   2.0084959e+00   2.0084959e+00   1.0559909e+00   1.0559909e+00  -8.3162139e-01  -8.3162139e-01  -8.3162139e-01   1.3298069e+00   1.3298069e+00   1.3298069e+00   1.3298069e+00   1.3298069e+00   1.3298069e+00   1.3298069e+00   1.3298069e+00   1.3298069e+00   1.7508711e+00   1.7508711e+00  -6.9404184e-01  -6.9404184e-01   6.2364821e-01   6.2364821e-01  -6.6967841e-01  -6.6967841e-01  -6.9950034e-02  -6.9950034e-02   6.2466883e-01   6.2466883e-01   6.2466883e-01   8.2845039e-01   8.2845039e-01   8.2845039e-01   1.4864957e+00   1.4864957e+00   1.4864957e+00   1.4864957e+00   1.4864957e+00   1.4864957e+00   9.9181526e-01   9.9181526e-01   9.9181526e-01   9.9181526e-01  -4.6773601e-01  -4.6773601e-01  -2.8341386e-01  -2.8341386e-01  -2.8341386e-01  -2.8341386e-01  -2.8341386e-01  -2.8341386e-01   6.4511441e-01   6.4511441e-01   6.4511441e-01   1.7218542e+00   1.7218542e+00   1.7218542e+00   3.0863590e-01   3.0863590e-01  -5.3798070e-01  -5.3798070e-01  -5.3798070e-01  -4.2327022e-01  -4.2327022e-01  -4.2327022e-01   1.1186586e+00   1.1186586e+00   1.1355497e+00   1.1355497e+00   1.1355497e+00  -1.5610748e-01  -1.6193739e+00  -1.6193739e+00  -1.2305412e+00   8.5757109e-01   8.5757109e-01   8.5757109e-01   8.5757109e-01   6.7240164e-02  -2.9429596e+00  -2.9429596e+00  -2.9429596e+00  -2.9429596e+00  -2.9429596e+00  -1.6347502e+00  -1.6347502e+00   1.8536825e+00   1.8536825e+00   1.9530534e+00   1.9530534e+00   9.4949559e-01   9.4949559e-01   9.4949559e-01   9.4949559e-01   8.4667571e-01   8.4667571e-01   8.4667571e-01   8.4667571e-01   8.4667571e-01   2.0870335e+00   2.0870335e+00  -2.0309068e-01  -2.0309068e-01  -2.0309068e-01  -7.4718133e-01  -7.4718133e-01   6.0778862e-01   6.0778862e-01   7.2037137e-01   7.2037137e-01   7.2037137e-01   7.2037137e-01  -1.2567161e+00   1.7750348e+00   1.7750348e+00   1.7750348e+00   1.7750348e+00   1.7750348e+00  -1.5238279e+00  -1.5238279e+00  -2.7466786e+00  -2.7466786e+00  -2.7466786e+00  -2.7466786e+00  -2.7466786e+00  -2.7466786e+00   1.2836370e+00   1.2836370e+00   1.2836370e+00   1.2836370e+00  -1.6091097e+00  -1.6091097e+00  -1.6091097e+00  -1.6091097e+00  -1.6091097e+00  -1.6091097e+00  -1.6091097e+00  -1.6091097e+00   8.4652977e-01   8.4652977e-01   1.4008792e+00   1.4008792e+00   1.4008792e+00   1.4008792e+00   1.4008792e+00   1.4008792e+00   1.8545663e+00   1.8545663e+00   1.8545663e+00   1.8545663e+00  -9.2214842e-01   1.7413725e-01   1.7413725e-01  -9.5615998e-01  -9.5615998e-01  -9.5615998e-01  -9.5615998e-01  -1.8400079e+00  -2.0915205e+00   1.1828640e+00   1.1828640e+00   1.2248108e+00   2.4557593e-01   2.4557593e-01   4.8740583e-01   1.2194654e-02   1.2194654e-02   2.7559826e+00   2.7559826e+00  -3.0317508e-01   2.5710558e+00   1.9488752e+00   1.9488752e+00   2.0275636e+00   2.0275636e+00   2.0275636e+00  -3.4268583e-01  -3.4268583e-01  -2.9957919e-02  -2.9957919e-02   8.0305011e-01   8.0305011e-01   8.0305011e-01   1.8149909e+00   1.8149909e+00   1.9150145e+00  -1.0572830e+00  -1.0572830e+00  -2.8480374e+00  -2.8480374e+00  -1.3442207e+00  -1.3442207e+00  -3.2158661e+00   1.5228183e+00   1.5228183e+00  -2.0529733e+00  -1.4616987e+00  -6.3277320e-01   1.9718853e+00  -2.6683251e-01  -2.6683251e-01   1.7757745e+00   1.1455260e+00   1.9530534e+00   1.9530534e+00   2.0974943e+00  -1.6624907e+00  -1.6624907e+00   1.8254765e+00   1.8254765e+00   1.8254765e+00   2.1213265e+00   2.1213265e+00   2.1213265e+00   1.4938399e+00   1.4938399e+00   1.4938399e+00   1.4938399e+00   1.4938399e+00   2.5111968e+00   2.5111968e+00   8.0305011e-01   8.0305011e-01   8.0305011e-01   8.0305011e-01   1.8393608e+00  -4.6964205e-01   1.1397007e+00  -1.3055663e+00  -1.3055663e+00   2.0265561e+00   2.0265561e+00   2.0265561e+00   9.1127534e-01   9.1127534e-01   8.9909632e-01   1.4572094e+00   1.4572094e+00  -2.2809594e+00  -2.2809594e+00   9.0052803e-01  -2.9920525e+00   3.7042081e-01   1.4355065e+00   1.4355065e+00   1.6480962e+00  -1.3321698e+00   1.7707014e+00   1.7707014e+00   1.1947441e+00  -1.1319945e+00  -6.4217018e-01  -5.3120960e+00   4.9439846e-01   2.8817446e+00  -2.0802893e+00  -5.4271755e+00  -8.6595464e-02  -8.8645405e-01  -8.8645405e-01  -8.8645405e-01  -8.8645405e-01  -1.7604736e+00  -1.3716206e+00  -1.1074854e+00   4.1667079e-01   4.1667079e-01  -2.1383376e-01  -1.3096230e-01  -1.3096230e-01   1.6631328e+00   2.3774305e+00  -2.2905041e+00   7.5320302e-01   7.5320302e-01  -1.6295593e+00   1.3668121e+00   1.9480675e+00   1.9480675e+00  -1.2647747e+00   5.3182965e-01  -2.6689353e+00  -1.1426981e+00  -1.7667268e-01  -1.7667268e-01  -5.8531569e-01   3.3402713e-01   2.2659026e+00   1.7380391e-01   1.7380391e-01  -1.3538049e+00   2.7155526e+00  -9.8280091e-01   8.4369354e-01  -1.0654992e+00  -4.9183165e-01   2.7599610e+00   2.7597430e+00   8.6045625e-01   8.6045625e-01   8.6045625e-01   2.8154578e+00  -1.5957948e+00   9.8164234e-01   1.3834890e+00   1.3834890e+00   1.8660934e+00   1.1828640e+00  -2.4585640e+00  -2.8182891e+00  -2.9302121e+00  -4.5139146e-01   9.3618109e-01  -2.8837723e+00  -3.0085266e+00   2.5808932e+00   1.2085066e+00   2.5730888e-01  -1.0917782e+00  -1.0917782e+00   1.8744451e+00  -1.8408821e+00  -1.1899322e+00   1.0945497e+00   1.0945497e+00  -1.2289105e+00  -1.1262440e+00   2.2813624e+00   1.6340720e+00   1.1369150e+00   1.1517763e+00   1.1782521e+00   1.4713142e+00   6.8559284e-01  -3.3919340e-01  -3.4268583e-01   1.7547995e+00   1.7547995e+00   1.7547995e+00   1.7547995e+00   5.2123564e-01  -6.2493786e-01  -6.9690159e-01  -6.9690159e-01  -6.9301116e-01  -7.7224954e-01  -3.5489804e+00   8.1451469e-01   8.1451469e-01   2.5544075e+00  -2.8480374e+00   2.1813990e+00   2.4009787e+00   2.4500091e+00   2.4500091e+00  -1.4731617e+00  -1.4232307e+00  -6.8241774e-01   1.3283858e-01  -3.1504270e+00  -3.1504270e+00  -1.1367623e+00  -6.9950034e-02   1.8826752e+00   1.9047436e+00   5.4707367e-02   1.1170208e+00   4.8108062e-01   1.0364081e+00   1.8540804e+00  -2.6138553e-01   9.3883280e-01   9.3883280e-01   5.7371286e-01   5.6537603e-01  -1.2918266e+00   2.5774916e+00   2.5774916e+00   2.5774916e+00   2.5774916e+00  -9.5815890e-02  -4.6773601e-01   9.4288756e-01  -6.9850542e-01  -1.8931485e+00   2.4184653e+00  -2.5542227e+00   1.9508969e+00   1.5103475e+00   1.7172650e+00  -1.1888115e+00  -1.4477515e+00  -1.2217546e+00   2.4501667e+00   2.4501667e+00   2.4293624e+00   2.4293624e+00  -2.1007404e-01   5.0233384e-01   1.0839812e+00   5.5335744e-01   1.3653323e+00  -2.3586834e-01   1.3743939e+00   1.3743939e+00  -2.8341386e-01  -2.0529733e+00   2.1067360e+00   8.5847809e-01   8.5847809e-01   8.5847809e-01   2.2021287e+00   1.7107167e+00   1.7107167e+00   1.7107167e+00   1.7107167e+00   1.4824424e+00   1.4824424e+00   1.4824424e+00  -1.9187505e-01   6.6593932e-02   1.1950272e-01  -6.8651810e-02  -1.0113313e+00   9.2366161e-01   9.2366161e-01  -7.1853642e-01  -7.1853642e-01   3.9601861e-01  -6.4264248e-01   2.3940692e+00   2.0579102e+00   2.0579102e+00  -2.4671911e+00  -1.4479717e+00   1.8819514e+00   1.8819514e+00   2.4385742e-01   2.4385742e-01   2.6780179e-01   2.6780179e-01   2.6572506e-01   1.7358527e-01   1.7358527e-01   4.2268516e-01   4.2268516e-01  -1.1421093e+00  -1.1421093e+00   1.9297032e+00   1.4904170e+00   1.6434903e+00  -4.2082535e-01  -1.6642215e+00  -1.6642215e+00  -2.5217907e+00   8.9364340e-02   2.3139615e-01   2.3139615e-01   2.3139615e-01   4.8962509e-01   4.8962509e-01  -9.3864806e-01   1.0259067e-01   8.2634840e-01  -1.5703084e+00  -1.5703084e+00   7.8392707e-01   7.8392707e-01   7.8392707e-01   7.8392707e-01  -1.6843604e+00  -1.6843604e+00   5.3392014e-01
          1.4184088e+01   1.4184088e+01   1.1761216e+01   1.1761216e+01   1.1761216e+01   1.0645966e+01   1.0645966e+01   1.0645966e+01   9.2967414e+00   9.2967414e+00   9.2967414e+00   1.1199398e+01   1.0391678e+01   1.0391678e+01   1.0391678e+01   1.0391678e+01   1.0926148e+01   1.0926148e+01   1.0926148e+01   1.0926148e+01   1.2691543e+01   1.2691543e+01   1.3905224e+01   1.3905224e+01   1.3905224e+01   1.3905224e+01   1.3905224e+01   1.4468008e+01   1.3981781e+01   1.3981781e+01   1.3981781e+01   1.3981781e+01   1.3401485e+01   1.3401485e+01   1.2943258e+01   1.2943258e+01   1.6391111e+01   1.6391111e+01   1.6391111e+01   1.2546051e+01   1.2546051e+01   1.2546051e+01   1.3276404e+01   1.3276404e+01   1.3276404e+01   1.3814381e+01   1.3814381e+01   1.2064581e+01   1.2064581e+01   1.2064581e+01   1.2682482e+01   1.2682482e+01   1.1581630e+01   1.1581630e+01   1.1581630e+01   1.1513858e+01   1.1513858e+01   1.1513858e+01   1.0145476e+01   1.0145476e+01   1.0145476e+01   1.0145476e+01   1.0868561e+01   1.1253393e+01   1.1253393e+01   1.1253393e+01   1.1253393e+01   1.1253393e+01   1.1524644e+01   1.1524644e+01   1.1524644e+01   1.0286575e+01   1.0286575e+01   1.0286575e+01   1.0482705e+01   1.0482705e+01   1.0482705e+01   1.0482705e+01   1.0482705e+01   1.0811391e+01   1.0811391e+01   1.0811391e+01   1.0811391e+01   1.0811391e+01   1.0811391e+01   1.4345481e+01   1.4345481e+01   1.4345481e+01   1.4345481e+01   1.3955712e+01   1.3955712e+01   1.3955712e+01   1.3993262e+01   1.3993262e+01   1.3993262e+01   1.3678879e+01   1.3678879e+01   1.3678879e+01   1.3678879e+01   1.3571231e+01   1.3571231e+01   1.2870455e+01   1.2870455e+01   1.0185168e+01   1.0185168e+01   1.0185168e+01   1.0185168e+01   1.0110886e+01   1.0110886e+01   1.2032978e+01   1.2032978e+01   1.3262644e+01   1.3262644e+01   1.3422947e+01   1.3422947e+01   1.3422947e+01   1.2782946e+01   1.2782946e+01   1.2782946e+01   1.0219750e+01   1.0219750e+01   1.0219750e+01   1.1846540e+01   1.1846540e+01   9.9445142e+00   9.9445142e+00   9.9445142e+00   1.1190817e+01   1.1190817e+01   1.0962702e+01   1.0962702e+01   1.0962702e+01   1.0962702e+01   1.0962702e+01   1.0962702e+01   1.0962702e+01   1.1933989e+01   1.1933989e+01   1.2036436e+01   1.2036436e+01   1.2160362e+01   1.2160362e+01   1.1937280e+01   1.1937280e+01   1.1937280e+01   1.1895645e+01   1.1895645e+01   1.1895645e+01   1.3173426e+01   1.3173426e+01   1.3464611e+01   1.3464611e+01   1.3464611e+01   1.3464611e+01   1.4094733e+01   1.4094733e+01   1.3220345e+01   1.3220345e+01   1.3163820e+01   1.3163820e+01   1.3163820e+01   1.3163820e+01   1.3163820e+01   1.3163820e+01   1.5290935e+01   1.5290935e+01   1.5290935e+01   1.5290935e+01   1.0710037e+01   1.0710037e+01   1.3535182e+01   1.3535182e+01   1.3807339e+01   1.3807339e+01   1.3807339e+01   1.2533071e+01   1.2533071e+01   1.2533071e+01   1.4775486e+01   1.4775486e+01   1.0600716e+01   1.0600716e+01   1.0600716e+01   1.0598200e+01   1.0598200e+01   1.0952043e+01   1.0952043e+01   1.0452584e+01   1.0452584e+01   1.0570443e+01   1.0570443e+01   1.0570443e+01   1.0570443e+01   1.1675653e+01   1.1675653e+01   1.0949373e+01   1.0949373e+01   1.1763096e+01   1.1763096e+01   1.0598396e+01   1.0598396e+01   1.0598396e+01   1.0598396e+01   1.0598396e+01   1.0598396e+01   1.1813265e+01   1.1813265e+01   1.2234439e+01   1.2234439e+01   1.2234439e+01   1.1922887e+01   1.1922887e+01   1.1922887e+01   1.1922887e+01   1.1922887e+01   1.1922887e+01   1.1922887e+01   1.1922887e+01   1.1922887e+01   1.1499577e+01   1.1499577e+01   1.6134376e+01   1.6134376e+01   1.3500159e+01   1.3500159e+01   1.4508571e+01   1.4508571e+01   1.1126371e+01   1.1126371e+01   1.2869956e+01   1.2869956e+01   1.2869956e+01   1.2954723e+01   1.2954723e+01   1.2954723e+01   1.1112254e+01   1.1112254e+01   1.1112254e+01   1.1112254e+01   1.1112254e+01   1.1112254e+01   1.0693418e+01   1.0693418e+01   1.0693418e+01   1.0693418e+01   1.1789009e+01   1.1789009e+01   1.2942562e+01   1.2942562e+01   1.2942562e+01   1.2942562e+01   1.2942562e+01   1.2942562e+01   1.3625780e+01   1.3625780e+01   1.3625780e+01   1.1273018e+01   1.1273018e+01   1.1273018e+01   1.1712789e+01   1.1712789e+01   1.0302767e+01   1.0302767e+01   1.0302767e+01   1.0162441e+01   1.0162441e+01   1.0162441e+01   1.0623870e+01   1.0623870e+01   1.0621558e+01   1.0621558e+01   1.0621558e+01   9.8610614e+00   9.8372022e+00   9.8372022e+00   9.6015541e+00   1.1806232e+01   1.1806232e+01   1.1806232e+01   1.1806232e+01   1.3427972e+01   1.3894991e+01   1.3894991e+01   1.3894991e+01   1.3894991e+01   1.3894991e+01   1.3097044e+01   1.3097044e+01   1.1387967e+01   1.1387967e+01   1.0856341e+01   1.0856341e+01   1.2847784e+01   1.2847784e+01   1.2847784e+01   1.2847784e+01   1.2981896e+01   1.2981896e+01   1.2981896e+01   1.2981896e+01   1.2981896e+01   1.0859186e+01   1.0859186e+01   1.2715295e+01   1.2715295e+01   1.2715295e+01   1.0750869e+01   1.0750869e+01   1.2643746e+01   1.2643746e+01   1.1003248e+01   1.1003248e+01   1.1003248e+01   1.1003248e+01   1.5305808e+01   1.0888707e+01   1.0888707e+01   1.0888707e+01   1.0888707e+01   1.0888707e+01   1.3472322e+01   1.3472322e+01   1.4212970e+01   1.4212970e+01   1.4212970e+01   1.4212970e+01   1.4212970e+01   1.4212970e+01   1.1075482e+01   1.1075482e+01   1.1075482e+01   1.1075482e+01   1.3945765e+01   1.3945765e+01   1.3945765e+01   1.3945765e+01   1.3945765e+01   1.3945765e+01   1.3945765e+01   1.3945765e+01   1.3219499e+01   1.3219499e+01   1.1444786e+01   1.1444786e+01   1.1444786e+01   1.1444786e+01   1.1444786e+01   1.1444786e+01   1.0892374e+01   1.0892374e+01   1.0892374e+01   1.0892374e+01   1.0823542e+01   1.3383393e+01   1.3383393e+01   1.3791378e+01   1.3791378e+01   1.3791378e+01   1.3791378e+01   1.5261262e+01   1.2991225e+01   1.2663097e+01   1.2663097e+01   1.1026730e+01   9.4304919e+00   9.4304919e+00   9.5064716e+00   1.2476861e+01   1.2476861e+01   9.6936640e+00   9.6936640e+00   1.2912259e+01   9.8723070e+00   1.0408519e+01   1.0408519e+01   1.0609889e+01   1.0609889e+01   1.0609889e+01   1.0857731e+01   1.0857731e+01   1.1911873e+01   1.1911873e+01   1.2591291e+01   1.2591291e+01   1.2591291e+01   1.1139199e+01   1.1139199e+01   1.0911012e+01   1.5609923e+01   1.5609923e+01   1.3491917e+01   1.3491917e+01   1.3651900e+01   1.3651900e+01   1.4780970e+01   1.1220132e+01   1.1220132e+01   1.5443980e+01   1.3094401e+01   1.2093708e+01   1.0969807e+01   1.1379381e+01   1.1379381e+01   1.1556511e+01   1.0698045e+01   1.0856341e+01   1.0856341e+01   1.1061434e+01   1.4800103e+01   1.4800103e+01   1.1341433e+01   1.1341433e+01   1.1341433e+01   1.0590062e+01   1.0590062e+01   1.0590062e+01   1.1305212e+01   1.1305212e+01   1.1305212e+01   1.1305212e+01   1.1305212e+01   1.0084744e+01   1.0084744e+01   1.2591291e+01   1.2591291e+01   1.2591291e+01   1.2591291e+01   1.0690819e+01   1.2057798e+01   1.1952682e+01   1.4386548e+01   1.4386548e+01   1.1009724e+01   1.1009724e+01   1.1009724e+01   1.2647736e+01   1.2647736e+01   1.2909825e+01   1.1614959e+01   1.1614959e+01   1.4080190e+01   1.4080190e+01   1.3377188e+01   1.3526114e+01   1.4242556e+01   1.2202580e+01   1.2202580e+01   1.1919782e+01   1.2089527e+01   1.0753694e+01   1.0753694e+01   1.0896203e+01   1.0067528e+01   1.1771430e+01   2.4150670e+01   1.1930905e+01   9.2873433e+00   1.9206126e+01   2.4835020e+01   1.2553973e+01   1.3703317e+01   1.3703317e+01   1.3703317e+01   1.3703317e+01   1.5231617e+01   1.3811158e+01   1.6010389e+01   1.3711412e+01   1.3711412e+01   1.4870802e+01   1.4814550e+01   1.4814550e+01   1.1634288e+01   1.0159193e+01   1.9864587e+01   1.3768142e+01   1.3768142e+01   1.2312464e+01   1.2444499e+01   1.0763979e+01   1.0763979e+01   1.2965676e+01   1.3686105e+01   1.4047805e+01   1.1696389e+01   1.2415196e+01   1.2415196e+01   1.0164596e+01   9.2482702e+00   9.6051030e+00   9.4897230e+00   9.4897230e+00   9.6672388e+00   9.5477184e+00   1.0420888e+01   1.1189806e+01   1.0257480e+01   1.3110496e+01   9.5784824e+00   9.6431655e+00   1.2637234e+01   1.2637234e+01   1.2637234e+01   9.5173758e+00   1.3220345e+01   1.3032381e+01   1.1998915e+01   1.1998915e+01   1.1123135e+01   1.2663097e+01   1.2888965e+01   1.2993662e+01   1.3757758e+01   1.1719334e+01   1.2977475e+01   1.4481738e+01   1.4483380e+01   9.4039361e+00   1.2226670e+01   1.1682157e+01   1.1941252e+01   1.1941252e+01   1.1033150e+01   1.1463127e+01   1.1955090e+01   1.0481652e+01   1.0481652e+01   1.2189314e+01   1.2361198e+01   2.1421949e+01   1.3494548e+01   1.0579697e+01   1.0557920e+01   1.0645750e+01   1.1128795e+01   9.7936464e+00   9.3433302e+00   1.0857731e+01   1.0929240e+01   1.0929240e+01   1.0929240e+01   1.0929240e+01   1.1191109e+01   1.1933989e+01   1.1915311e+01   1.1915311e+01   1.2036436e+01   1.2160362e+01   1.4944322e+01   1.2660613e+01   1.2660613e+01   9.5023142e+00   1.3491917e+01   1.0716706e+01   1.0167783e+01   9.5442252e+00   9.5442252e+00   1.2551842e+01   1.3141158e+01   1.3256811e+01   1.2320802e+01   1.5259936e+01   1.5259936e+01   1.0503146e+01   1.1126371e+01   1.0849090e+01   1.1426571e+01   1.0952091e+01   1.0763889e+01   9.4334513e+00   1.7879992e+01   1.0779035e+01   9.5095660e+00   1.0295861e+01   1.0295861e+01   9.5869886e+00   9.6522788e+00   1.1555876e+01   1.0899965e+01   1.0899965e+01   1.0899965e+01   1.0899965e+01   1.2329270e+01   1.1789009e+01   1.1613899e+01   1.3208798e+01   1.2958271e+01   1.0335838e+01   1.3144402e+01   1.0641502e+01   1.1866206e+01   1.1177495e+01   1.3595057e+01   1.1628388e+01   1.1280159e+01   9.6829490e+00   9.6829490e+00   9.8183037e+00   9.8183037e+00   1.0463915e+01   9.5113295e+00   1.0531623e+01   9.5659799e+00   1.1194517e+01   1.0947700e+01   1.1292416e+01   1.1292416e+01   1.2942562e+01   1.5443980e+01   1.0739591e+01   1.3410587e+01   1.3410587e+01   1.3410587e+01   1.0157457e+01   1.1857402e+01   1.1857402e+01   1.1857402e+01   1.1857402e+01   1.2165576e+01   1.2165576e+01   1.2165576e+01   1.0597105e+01   1.1103138e+01   1.1106988e+01   1.0442393e+01   1.1867899e+01   1.0249789e+01   1.0249789e+01   1.0576664e+01   1.0576664e+01   1.2197645e+01   1.2286431e+01   1.0229626e+01   1.0710214e+01   1.0710214e+01   1.2970880e+01   1.1487701e+01   1.1510589e+01   1.1510589e+01   9.4120398e+00   9.4120398e+00   9.4202850e+00   9.4202850e+00   9.3504499e+00   1.1632823e+01   1.1632823e+01   1.2315260e+01   1.2315260e+01   1.4066347e+01   1.4066347e+01   1.1303652e+01   1.2726636e+01   1.1782220e+01   9.7243258e+00   1.4927388e+01   1.4927388e+01   1.5595742e+01   1.2183857e+01   1.2411311e+01   1.2411311e+01   1.2411311e+01   1.2985828e+01   1.2985828e+01   1.3646035e+01   1.0155858e+01   1.0681924e+01   9.8009265e+00   9.8009265e+00   1.2311954e+01   1.2311954e+01   1.2311954e+01   1.2311954e+01   1.1659043e+01   1.1659043e+01   1.4795970e+01];
    P =  1.0e+03*[1.0912    0.0009    0.5502   -0.0446
                  0.0021    1.0904    0.4255   -0.0416
                  0.0000    0.0000    0.0010   -0.0001];
    ba.proj_func = 3; % projection function
    ba.constant_cameras = [0]; % fixed cameras
    ba.constant_points = ones(1,size(Y,2)); % fixed points
    ba.p_tolerance = 1e-8; % stopping criterion - change of optimized variables
    ba.g_tolerance = 1e-8; % stopping criterion - size of the gradien
    ba.f_tolerance = 1e-8; % stopping criterion - change of the objective        
    ba.num_iterations = 5; % the maximum number of LM iterations, default 5
    ba.robustify = 0; % robust loss function (0 - least squares, 1 - Huber's loss), default 0
    ba.num_threads = 4; % number of threads, default 1
    ba.verbose = 0; % info printout on
    [z,BP,Z,eo] = uPXBA({y},{P},Y,ba);
    subfig(2,3,1);
    plot(1:size(y,2),vnorm(h2a(X2u(Y,P))-y),'.-r',1:size(y,2),vnorm(h2a(X2u(Y,BP{1}))-y),'.-b'); 
    axis tight; grid
    legend('Before BA','After BA');
    title(sprintf('Test 01 - reprojection error max=[%.2f->%.2f]',max(vnorm(h2a(X2u(Y,P))-y)),max(vnorm(h2a(X2u(Y,BP{1}))-y))));
    xlabel('point');ylabel('pixels');
    subfig(2,3,2);
    plot3d(y,'.'); hold; plot3d(h2a(X2u(Y,P)),'.r'); plot3d(h2a(X2u(Y,BP{1})),'.g');
    axis tight;axis equal
    title('image reprojections: b - image points, r - before BA, g - after BA')
    u.ok = all((Z(:)-Y(:))==0) && max(vnorm(h2a(X2u(Y,BP{1}))-y))<1.66;
    % two views
    [PP,Y,in,e,~,y,f] = uu2PPXRFit; % initialize a reconstruction
    ba.proj_func = 3; % projection function
    ba.constant_cameras = zeros(1,numel(PP)); % fixed cameras
    ba.constant_points = zeros(1,size(Y,2)); % fixed points
    ba.p_tolerance = 1e-8; % stopping criterion - change of optimized variables
    ba.g_tolerance = 1e-8; % stopping criterion - size of the gradien
    ba.f_tolerance = 1e-8; % stopping criterion - change of the objective        
    ba.num_iterations = 3; % the maximum number of LM iterations, default 5
    ba.robustify = 0; % robust loss function (0 - least squares, 1 - Huber's loss), default 0
    ba.num_threads = 4; % number of threads, default 1
    ba.verbose = 1; % info printout on
    [z,BP,Z,eo] = uPXBA({y{1}(:,in),y{2}(:,in)},PP,Y,ba);
    % plot results
    subfig(2,6,10);
    semilogy(eo,'.-'); axis tight
    xlabel('iteration');ylabel('mean(dx(i)^2)/2');title('BA: mean rep err');
    figure(f(1));
    plot3d(Z,'og');
    h = cellfun(@plotCam,BP,'UniformOutput',false);
    cellfun(@(x) set(x,'color','g'),h);
    axis equal; grid on;
    title('3D points & cams: b=true, r=E-init, g=BA')
    subfig(2,6,11)
    CC2 = (inv(PP{2}(:,1:3))*PP{2}(:,end));
    BC2 = (inv(BP{2}(:,1:3))*BP{2}(:,end));
    plottab([CC2',NaN;
             BC2',NaN;
             (BC2-CC2)',vnorm(BC2-CC2)],...
             ['C2     ';'BC2    ';'BC2-C2 '],[' ';'v';' ';'d'],'','%.2f');
    title('2nd cam C: C2 - init, BC2 - BA');
    u.test{end+1} = 'Two view demo';
    u.ok(end+1) = true;
end

